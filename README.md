# SafetyScooter — мобильное приложение для фиксации нарушений

**SafetyScooter** — это Android-приложение, которое позволяет пользователю записывать короткие видеоролики нарушений, автоматически сохранять и отправлять данные на сервер для дальнейшей проверки.

Приложение поддерживает:
- авторизацию и регистрацию;
- запись видео с камерой;
- привязку GPS-координат;
- отправку данных на сервер;
- просмотр истории заявок;
- экран профиля и выход из аккаунта.

---

## Основные возможности

### 1. Запись видео нарушения

- Запись видео длительностью до **20 секунд**.
- Используется библиотека **CameraX**.
- Встроенный таймер обратного отсчёта.
- Возможность остановить запись вручную в любой момент.

---

### 2. Сбор GPS-координат

- Во время записи приложение собирает геолокацию пользователя.
- Для каждой секунды записи гарантируется наличие хотя бы одной GPS-точки.
- Используется **FusedLocationProviderClient** с высоким приоритетом точности.
- Геоданные передаются на сервер вместе с видеозаписью.

---

### 3. Отправка видео на сервер

- Видео и координаты отправляются одним **multipart**-запросом.
- Используется **OkHttp** и кастомный `RequestBody` для отслеживания прогресса.
- Во время загрузки пользователь видит:
  - сколько мегабайт отправлено и сколько всего;
  - текстовое состояние: «идёт загрузка», «успешно» или «ошибка».
- Состояние загрузки реализовано через **StateFlow**, UI подписан на это состояние и обновляется в реальном времени.

---

### 4. История заявок

- Приложение получает список заявок с сервера.
- Для каждой заявки отображаются:
  - дата и время фиксации;
  - статус обработки (например, «отправлено», «проверяется», «нарушение обнаружено», «ошибка»);
  - количество вердиктов по заявке;
  - локальный порядковый номер.
---

### 5. Профиль пользователя

- Авторизация и регистрация по номеру телефона и паролю.
- Валидация номера телефона в формате `+7` и 10 цифр.
- Валидация пароля:
  - длина от 8 до 16 символов;
  - только латинские буквы и цифры.
- Сохранение `access_token` и номера телефона в **SharedPreferences**.
- Экран профиля:
  - показывает текущий номер пользователя;
  - содержит кнопку выхода, которая очищает сохранённые данные и возвращает пользователя к экрану входа.

---

## Используемые технологии

- **Kotlin** — основной язык разработки.
- **CameraX** — работа с камерой и запись видео.
- **Kotlin Coroutines** — асинхронные операции.
- **StateFlow** — реактивное обновление интерфейса по состоянию загрузки и статусов.
- **ViewBinding** — безопасный и удобный доступ к элементам разметки.
- **RecyclerView + ListAdapter + DiffUtil** — эффективное отображение списков заявок.
- **FusedLocationProviderClient** — получение точных GPS-координат.
- **OkHttp** — реализация HTTP-клиента.
- **Gson** — сериализация и десериализация JSON.
- **SharedPreferences** — хранение токена и минимальных пользовательских данных.

---

## Логика работы приложения

1. Пользователь открывает приложение.
2. Если сохранён `access_token`, он сразу попадает на главный экран. Если нет — на экран авторизации.
3. После входа пользователь может:
   - начать запись нарушения;
   - перейти к истории своих заявок;
   - открыть экран профиля.
4. При записи:
   - идёт съёмка видео;
   - параллельно собираются координаты.
5. После завершения записи пользователь попадает на экран просмотра видео и может отправить его на сервер.
6. Во время отправки отображается прогресс загрузки и результат (успех/ошибка).
7. Отправленные нарушения появляются в списке заявок.
8. При выходе из профиля токен и данные пользователя очищаются.

